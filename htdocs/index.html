<html>
    <head>
        <title>SrcUrl.Net</title>
        <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css" rel="stylesheet"/>
        <script type="text/javascript">

function splitFilename(str) {
    lastDot = str.lastIndexOf(".");
    if (lastDot > 0) {
        secondToLastDot = str.lastIndexOf(".", lastDot - 1);
        if (str.substr(secondToLastDot, 4) == ".tar")
            return [str.substr(0, secondToLastDot), str.substr(secondToLastDot)];
        else
            return [str.substr(0, lastDot), str.substr(lastDot)];
    } else {
        return [str, ""];
    }
}

function convertUrl(origUrl) {
    var splitUrl = origUrl.split("/");
    var site = splitUrl[2].split(".", 1);
    var filename = splitFilename(splitUrl[6]);
    return "http://" + site + ".srcurl.net/" + splitUrl[3] + "/" + splitUrl[4] + "/" + filename[0] + "/" + splitUrl[4] + "-" + filename[0] + filename[1];
}

function processForm() {
    document.getElementById("id_output").value = convertUrl(document.getElementById("id_input").value);
}

        </script>
    </head>
    <body>
        <div class="container">
            <h1>SrcUrl.Net</h1>
            <p>
                This simple service is aimed to redirect nice tarball urls to the original urls used by various websites.
                This is usefull if the filename is not part of the original url.
            </p>
            <p>
                Feel free to ask me any question related to this service or propose new functions <a href="https://github.com/misli/srcurl.net">on GitHub</a>.
            </p>

            <h2>Try it yourself</h2>
            <p>
                Put your url into the first field and see the SrcUrl.Net url in the second one.
            </p>
            <div class="row">
                <label class="col-sm-3" for="id_input">Original URL:</label>
                <input class="col-xs-12 col-sm-9" type="text" name="input"  id="id_input"  onchange="processForm()" onkeyup="processForm()" value="https://github.org/misli/srcurl.net/archive/master.tar.gz"/>
            </div>
            <div class="row">
                <label class="col-sm-3" for="id_output">SrcUrl.Net URL:</label>
                <input class="col-xs-12 col-sm-9" type="text" name="output" id="id_output" onclick="this.select()" onfocus="this.select()"/>
            </div>
            <script language="javascript">processForm()</script>

            <h2>GitHub</h2>
            <table class="table">
                <tr>
                    <th>SrcUrl.Net url</th>
                    <th>GitHub url</th>
                </tr>
                <tr>
                    <td>http://github.srcurl.net/<i>[user]</i>/<i>[project]</i>/<i>[tag]</i>/*.tar.gz</td>
                    <td>https://github.com/<i>[user]</i>/<i>[project]</i>/archive/<i>[tag]</i>.tar.gz</td>
                </tr>
                <tr>
                    <td>http://github.srcurl.net/<i>[user]</i>/<i>[project]</i>/<i>[tag]</i>/*.zip</td>
                    <td>https://github.com/<i>[user]</i>/<i>[project]</i>/archive/<i>[tag]</i>.zip</td>
                </tr>
            </table>

            <h2>Bitbucket</h2>
            <table class="table">
                <tr>
                    <th>SrcUrl.Net url</th>
                    <th>Bitbucket url</th>
                </tr>
                <tr>
                    <td>http://bitbucket.srcurl.net/<i>[user]</i>/<i>[project]</i>/<i>[tag]</i>/*.tar.gz</td>
                    <td>https://bitbucket.org/<i>[user]</i>/<i>[project]</i>/get/<i>[tag]</i>.tar.gz</td>
                </tr>
                <tr>
                    <td>http://bitbucket.srcurl.net/<i>[user]</i>/<i>[project]</i>/<i>[tag]</i>/*.tar.bz2</td>
                    <td>https://bitbucket.org/<i>[user]</i>/<i>[project]</i>/get/<i>[tag]</i>.tar.bz2</td>
                </tr>
                <tr>
                    <td>http://bitbucket.srcurl.net/<i>[user]</i>/<i>[project]</i>/<i>[tag]</i>/*.zip</td>
                    <td>https://bitbucket.org/<i>[user]</i>/<i>[project]</i>/get/<i>[tag]</i>.zip</td>
                </tr>
            </table>
        </div>
    </body>
</html>
